(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[707],{8388:function(k,I,r){"use strict";r.d(I,{v:function(){return F}});var B=["https://livedb.asoulfan.com","https://raw.githubusercontent.com/A-Soul-Database/A-Soul-Data/main","https://cdn.jsdelivr.net/gh/A-Soul-Database/A-Soul-Data@latest","https://gitee.com/lairq/A-Soul-Data/raw/main"],X="8001",T="https://apihk.asdb.live/Api/Subtitle_Search/sub_search",L=0,x="https://apihk.asdb.live/Api/List_Json/V1",F={RunOnLocal:L!==0,sourceUrl:B[L],queryAPI:T,FliterApi:x+"/Main_Fliter",MainJsonAPI:x+"/Main_Data",IndexerAPI:x+"/Indexer_Data",SubtitlesAPI:x+"/Srt_Data"}},12061:function(k,I,r){"use strict";r.d(I,{VO:function(){return T},Zx:function(){return L},Yu:function(){return x},GP:function(){return F}});var B=null;function X(u,s){{var l=new Set,D=_createForOfIteratorHelper(s.staff),p;try{for(D.s();!(p=D.n()).done;){var O=p.value;if(O!=="F"){var W=_createForOfIteratorHelper(s.skin[O]),h;try{for(W.s();!(h=W.n()).done;){var Y=h.value;l.add(Y)}}catch(v){W.e(v)}finally{W.f()}}}}catch(v){D.e(v)}finally{D.f()}var _=Array.from(l);if(_.length!==0&&!w(u.skin,_))return!1}var K=_createForOfIteratorHelper(B),U;try{for(K.s();!(U=K.n()).done;){var A=U.value;if(!w(u[A],s[A]))return!1}}catch(v){K.e(v)}finally{K.f()}if(u.titlestr===""&&u.tagstr===""&&u.typestr===""||s.title.toLowerCase().indexOf(u.titlestr.toLowerCase())!==-1)return!0;{var b=_createForOfIteratorHelper(s.tags),V;try{for(b.s();!(V=b.n()).done;){var J=V.value;if(J.toLowerCase().indexOf(u.tagstr.toLowerCase())!==-1)return!0}}catch(v){b.e(v)}finally{b.f()}}{var S=_createForOfIteratorHelper(s.items),H;try{for(S.s();!(H=S.n()).done;){var G=H.value,R=_createForOfIteratorHelper(G.item),N;try{for(R.s();!(N=R.n()).done;){var Z=N.value;if(Z[0].toLowerCase().indexOf(u.typestr.toLowerCase())!==-1)return!0}}catch(v){R.e(v)}finally{R.f()}}}catch(v){S.e(v)}finally{S.f()}}return!1}function T(u){var s=new XMLHttpRequest;s.open("GET",u,!1),s.send(null);var l;try{l=JSON.parse(s.responseText)}catch(D){l={title:"error"}}finally{return l}}function L(u,s){var l=new XMLHttpRequest;l.open("POST",u,!1),l.setRequestHeader("Content-Type","application/json");var D=JSON.stringify(s);l.send(D);var p;try{p=JSON.parse(l.responseText)}catch(O){p={title:"error"}}finally{return p}}function x(u){var s=new XMLHttpRequest;s.open("GET",u,!1),s.send(null);var l;if(s.status!==200)throw s.status;try{l=s.responseText}catch(D){throw l="error http",l}finally{return l}}function F(u){for(var s=[],l=u.length-1;l>=0;l--)s.push(u[l]);return s}function w(u,s){return u.length+s.length!==Array.from(new Set([].concat(_toConsumableArray(u),_toConsumableArray(s)))).length}},49793:function(k,I,r){"use strict";r.r(I);var B=r(49426),X=r(91273),T=r(17067),L=r(73667),x=r(1900),F=r(85489),w=r(41132),u=r(16613),s=r(5981),l=r(73025),D=r(11108),p=r(9882),O=r(62377),W=r(53168),h=r(27274),Y=r(30606),_=r(25861),K=r(9916),U=r(90757),A=r(59301),b=r(38219),V=r(54348),J=r(18999),S=r(89122),H=r(14687),G=r(18422),R=r(60775),N=r.n(R),Z=r(12061),v=r(8388),q=r(45504),t=r(37712),$=U.Z.Title,ee=U.Z.Text,te="yellow";function re(g){var c=(0,Z.VO)(v.v.SubtitlesAPI+"?bv="+g).data;console.log(c);for(var i=0;i<c.sources.length;i++){var d=c.sources[i];console.log("try source:"+d);try{for(var e=Array(c.url.length),n=0;n<c.url.length;n++)e[n]=[];for(var a=0;a<c.url.length;a++){var o=c.url[a],E=d+o,P="";try{P=(0,Z.Yu)(E)}catch(y){throw console.error("getSubtitles fail, status:"+y.toString()),d}for(var m=P.split(`
`),f=0;f<m.length-2;f+=4){var M=m[f]+"|"+m[f+1]+"|"+m[f+2];e[a].push(M)}}return e}catch(y){console.warn("source: "+d+" cannnot be used, try next source");continue}}console.error("All sources cannot be used!");for(var C=Array(c.url.length),j=0;j<c.url.length;j++)C[j]=[];return C}var ne=[{title:"\u65E5\u671F",width:80,dataIndex:"date"},{title:"\u65F6\u95F4",width:80,dataIndex:"hour"},{title:"BV\u53F7",width:80,dataIndex:"bv",render:function(c){return(0,t.jsx)("a",{href:"https://www.bilibili.com/"+c,target:"_blank",onClick:function(d){d.stopPropagation()},children:c})}},{title:"\u6807\u9898",dataIndex:"title",render:function(c){return(0,t.jsx)(h.Z,{children:(0,t.jsx)(_.Z,{md:12,children:c})})}}],ae=function(g){(0,p.Z)(i,g);var c=(0,O.Z)(i);function i(d){var e;return(0,l.Z)(this,i),e=c.call(this,d),e.state={input:""},e.handleSearch=function(n){e.props.parent.handleSearch(e.state.input)},e.handleClear=function(n){e.setState({input:""});var a=e.props.parent.props.initDatasrc;e.props.parent.setState({dataSource:a,searchWords:"",currentID:0})},e.handleReverse=function(n){e.props.parent.handleReverse()},e}return(0,D.Z)(i,[{key:"render",value:function(){var e=this;return(0,t.jsxs)(w.Z,{onKeyDown:function(a){a.keyCode===13&&e.handleSearch(a)},actions:[(0,t.jsx)(V.Z,{title:"\u9006\u5E8F",onClick:this.handleReverse}),(0,t.jsx)(J.Z,{title:"\u6E05\u9664\u9009\u62E9",onClick:this.handleClear}),(0,t.jsx)(S.Z,{title:"\u641C\u7D22",onClick:this.handleSearch})],children:[(0,t.jsx)(h.Z,{children:(0,t.jsx)(_.Z,{xs:24,md:24,align:"middle",children:(0,t.jsx)($,{level:2,children:"\u5B57\u5E55\u5E93\u68C0\u7D22"})})}),(0,t.jsxs)(h.Z,{style:{height:"50px"},children:[(0,t.jsx)(_.Z,{xs:0,md:6}),(0,t.jsx)(_.Z,{xs:24,md:12,align:"middle",children:(0,t.jsx)(s.Z,{style:{borderRadius:"50px"},placeholder:"\u5355\u6761\u5B57\u5E55\u68C0\u7D22\u{1F50D}",onChange:function(a){e.setState({input:a.target.value})},value:this.state.input})}),(0,t.jsx)(_.Z,{md:6,align:"middle"})]})]})}}]),i}(A.Component),se=function(g){(0,p.Z)(i,g);var c=(0,O.Z)(i);function i(d){var e;return(0,l.Z)(this,i),e=c.call(this,d),e.state={dataSource:e.props.initDatasrc,isModalVisible:!1,displayBV:"",searchWords:"",currentID:0},e.handleCancel=function(){e.scrollTop(),e.setState({isModalVisible:!1,currentID:0})},e.handleSearch=function(n){e.setState({searchWords:n}),fetch("".concat(v.v.queryAPI),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({words:n})}).then(function(a){a.json().then(function(o){e.setState({dataSource:o});var E=o.length;x.default.info("\u5171"+E.toString()+"\u6761\u641C\u7D22\u7ED3\u679C\u5DF2\u5C55\u793A")})},function(a){console.error(a),x.default.error("\u5B57\u5E55\u5E93\u641C\u7D22\u5931\u8D25")})},e.scrollTop=function(){var n=document.getElementById("Table-top");n.scrollIntoView({behavior:"auto"})},e.scrollNext=function(n){var a=document.getElementsByClassName(n);if(a.length!==0){var o=e.state.currentID;a[o].scrollIntoView({behavior:"smooth"}),o>=a.length-1?e.setState({currentID:0}):e.setState({currentID:o+1})}},e.scrollPre=function(n){var a=document.getElementsByClassName(n);if(a.length!=0){var o=e.state.currentID;a[o].scrollIntoView({behavior:"smooth"}),o<=0?e.setState({currentID:a.length-1}):e.setState({currentID:o-1})}},e}return(0,D.Z)(i,[{key:"componentDidUpdate",value:function(){var e=this.props,n=e.reRender,a=e.parent,o=e.initDatasrc;n&&(this.setState({dataSource:o}),a.setState({reRender:!1}))}},{key:"handleReverse",value:function(){var e=(0,Z.GP)(this.state.dataSource);this.setState({dataSource:e})}},{key:"render",value:function(){var e=this,n=this.state,a=n.isModalVisible,o=n.displayBV,E=n.searchWords,P=[];return o!==""&&(P=re(o)),(0,t.jsxs)(b.ZP,{children:[(0,t.jsx)(ae,{parent:this}),(0,t.jsx)(h.Z,{style:{marginTop:"20px"},children:(0,t.jsx)(_.Z,{xs:24,md:24,children:(0,t.jsx)(q.ZP,{columns:this.props.initColumns,rowKey:"key",dataSource:this.state.dataSource,search:!1,onRow:function(f){return{onClick:function(C){e.setState({isModalVisible:!0,displayBV:f.bv})},style:{cursor:"pointer"}}}})})}),(0,t.jsxs)(T.Z,{id:"modal",visible:a,maskClosable:!0,onCancel:this.handleCancel,footer:null,children:[(0,t.jsx)(h.Z,{children:(0,t.jsx)(_.Z,{xs:24,md:24,align:"middle",children:(0,t.jsx)($,{children:"\u5B57\u5E55\u8868"})})}),(0,t.jsx)(h.Z,{children:(0,t.jsx)(_.Z,{children:(0,t.jsxs)("a",{onClick:function(){return e.scrollPre("active-highlight")},children:[(0,t.jsx)(H.Z,{}),"\u4E0A\u4E00\u6761\u641C\u7D22\u7ED3\u679C"]})})}),(0,t.jsx)(h.Z,{children:(0,t.jsx)(_.Z,{children:(0,t.jsxs)("a",{onClick:function(){return e.scrollNext("active-highlight")},children:[(0,t.jsx)(G.Z,{}),"\u4E0B\u4E00\u6761\u641C\u7D22\u7ED3\u679C"]})})}),(0,t.jsxs)(h.Z,{children:[(0,t.jsx)(_.Z,{xs:3,md:3,children:"\u5E8F\u53F7"}),(0,t.jsx)(_.Z,{xs:10,md:10,children:"\u65F6\u95F4"}),(0,t.jsx)(_.Z,{xs:11,md:11,children:"\u5B57\u5E55"})]}),(0,t.jsx)(h.Z,{style:{borderBottom:"2px solid"},children:(0,t.jsx)(ee,{type:"secondary",children:"\u5B57\u5E55\u641C\u7D22\u7ED3\u679C\u4F1A\u4EE5\u9AD8\u4EAE\u5C55\u793A\uFF0C\u7528\u6309\u952E\u4E0A\u4E0B\u79FB\u52A8\u5427\u{1F483}\u{1F483}\u{1F483}"})}),(0,t.jsx)(h.Z,{children:(0,t.jsx)(_.Z,{span:24,style:{height:"500px",overflowY:"scroll"},children:P.map(function(m,f){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.Z,{children:(0,t.jsx)(_.Z,{style:{color:"#9AC8E2",borderBottom:"1px solid"},id:"Table-top",children:(0,t.jsx)("a",{target:"_blank",href:"https://www.bilibili.com/"+o+"?p="+(f+1),children:"\u5207\u7247"+(f+1)})})}),(0,t.jsx)(t.Fragment,{children:m.map(function(M){var C=M.split("|"),j=C[0],y=C[1],z=C[2],oe=parseInt(y.split("-->")[0].split(":")[0]),ie=parseInt(y.split("-->")[0].split(":")[1]),ue=parseInt(y.split("-->")[0].split(":")[2].split(",")[0]),ce=(oe*3600+60*ie+ue)*1e3,de="https://www.bilibili.com/"+o+"?p="+(f+1)+"&start_progress="+ce,Q="";return z.toLowerCase().indexOf(E.toLowerCase())!==-1&&(Q="active-highlight"),(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(h.Z,{style:{borderBottom:"1px dashed"},className:Q,children:[(0,t.jsx)(_.Z,{xs:3,md:3,style:{color:"#B8A6D9"},children:j}),(0,t.jsx)(_.Z,{xs:10,md:10,children:(0,t.jsx)("a",{target:"_blank",href:de,children:y})}),(0,t.jsx)(_.Z,{xs:11,md:11,style:{color:"#E799B0"},children:(0,t.jsx)(N(),{highlightStyle:{backgroundColor:te,padding:0},searchWords:[E],autoEscape:!0,textToHighlight:z})})]})})})})]})})})})]})]})}}]),i}(A.Component),le=function(g){(0,p.Z)(i,g);var c=(0,O.Z)(i);function i(){var d;(0,l.Z)(this,i);for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return d=c.call.apply(c,[this].concat(n)),d.state={mainJson:[],indexerList:[],reRender:!1},d}return(0,D.Z)(i,[{key:"cancelRerender",value:function(){this.setState({reRender:!1}),console.log("\u5DF2\u53D6\u6D88")}},{key:"componentDidMount",value:function(){var e=this;fetch(v.v.MainJsonAPI+"?brief=true").then(function(n){return n.json().then(function(a){e.setState({mainJson:a.data,reRender:!0}),console.log("mainJson\u83B7\u53D6\u6210\u529F")})},function(n){console.error(n)})}},{key:"render",value:function(){var e=this.state,n=e.mainJson,a=e.reRender,o=[];for(var E in n){var P=void 0,m=void 0,f=void 0,M=void 0;try{P=n[E].title,m=n[E].bv,f=n[E].date,M=n[E].time}catch(j){console.error("mainJson parse fault for n: "+E)}o.push({key:E,date:f,hour:M,bv:m,title:P})}o=(0,Z.GP)(o);var C={initColumns:ne,initDatasrc:o,reRender:a,parent:this};return(0,t.jsx)(se,(0,B.Z)({},C))}}]),i}(A.Component);I.default=le}}]);
