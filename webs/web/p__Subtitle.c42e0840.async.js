(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[707],{43313:function(k,y,r){"use strict";r.d(y,{v:function(){return U}});var Z=["https://maindata.a-soul-database.vercel.app","https://cdn.jsdelivr.net/gh/A-Soul-Database/A-Soul-Data@latest"],X="8001",B="https://apihk.asdb.live/Api/Subtitle_Search/sub_search",T=0,x="https://apihk.asdb.live/Api/List_Json/V1",U={RunOnLocal:T!==0,sourceUrl:Z[T],queryAPI:B,FliterApi:x+"/Main_Fliter",MainJsonAPI:x+"/Main_Data",IndexerAPI:x+"/Indexer_Data",SubtitlesAPI:x+"/Srt_Data"}},53668:function(k,y,r){"use strict";r.d(y,{VO:function(){return B},Zx:function(){return T},Yu:function(){return x},GP:function(){return U}});var Z=null;function X(u,s){{var l=new Set,D=_createForOfIteratorHelper(s.staff),m;try{for(D.s();!(m=D.n()).done;){var P=m.value;if(P!=="F"){var L=_createForOfIteratorHelper(s.skin[P]),h;try{for(L.s();!(h=L.n()).done;){var Y=h.value;l.add(Y)}}catch(v){L.e(v)}finally{L.f()}}}}catch(v){D.e(v)}finally{D.f()}var _=Array.from(l);if(_.length!==0&&!w(u.skin,_))return!1}var W=_createForOfIteratorHelper(Z),K;try{for(W.s();!(K=W.n()).done;){var I=K.value;if(!w(u[I],s[I]))return!1}}catch(v){W.e(v)}finally{W.f()}if(u.titlestr===""&&u.tagstr===""&&u.typestr===""||s.title.toLowerCase().indexOf(u.titlestr.toLowerCase())!==-1)return!0;{var A=_createForOfIteratorHelper(s.tags),V;try{for(A.s();!(V=A.n()).done;){var J=V.value;if(J.toLowerCase().indexOf(u.tagstr.toLowerCase())!==-1)return!0}}catch(v){A.e(v)}finally{A.f()}}{var j=_createForOfIteratorHelper(s.items),H;try{for(j.s();!(H=j.n()).done;){var G=H.value,b=_createForOfIteratorHelper(G.item),N;try{for(b.s();!(N=b.n()).done;){var R=N.value;if(R[0].toLowerCase().indexOf(u.typestr.toLowerCase())!==-1)return!0}}catch(v){b.e(v)}finally{b.f()}}}catch(v){j.e(v)}finally{j.f()}}return!1}function B(u){var s=new XMLHttpRequest;s.open("GET",u,!1),s.send(null);var l;try{l=JSON.parse(s.responseText)}catch(D){l={title:"error"}}finally{return l}}function T(u,s){var l=new XMLHttpRequest;l.open("POST",u,!1),l.setRequestHeader("Content-Type","application/json");var D=JSON.stringify(s);l.send(D);var m;try{m=JSON.parse(l.responseText)}catch(P){m={title:"error"}}finally{return m}}function x(u){var s=new XMLHttpRequest;s.open("GET",u,!1),s.send(null);var l;if(s.status!==200)throw s.status;try{l=s.responseText}catch(D){throw l="error http",l}finally{return l}}function U(u){for(var s=[],l=u.length-1;l>=0;l--)s.push(u[l]);return s}function w(u,s){return u.length+s.length!==Array.from(new Set([].concat(_toConsumableArray(u),_toConsumableArray(s)))).length}},145:function(k,y,r){"use strict";r.r(y);var Z=r(75106),X=r(83166),B=r(94352),T=r(94966),x=r(46429),U=r(79873),w=r(66551),u=r(96343),s=r(74280),l=r(54597),D=r(2431),m=r(67857),P=r(77852),L=r(61947),h=r(58336),Y=r(12489),_=r(53530),W=r(91434),K=r(53104),I=r(59301),A=r(22444),V=r(54348),J=r(18999),j=r(89122),H=r(14687),G=r(18422),b=r(50666),N=r.n(b),R=r(53668),v=r(43313),q=r(74414),t=r(37712),$=K.Z.Title,ee=K.Z.Text,te="yellow";function re(g){var d=(0,R.VO)(v.v.SubtitlesAPI+"?bv="+g).data;console.log(d);for(var i=0;i<d.sources.length;i++){var c=d.sources[i];console.log("try source:"+c);try{for(var e=Array(d.url.length),n=0;n<d.url.length;n++)e[n]=[];for(var a=0;a<d.url.length;a++){var o=d.url[a],E=c+o,C="";try{C=(0,R.Yu)(E)}catch(M){throw console.error("getSubtitles fail, status:"+M.toString()),c}for(var p=C.split(`
`),f=0;f<p.length-2;f+=4){var O=p[f]+"|"+p[f+1]+"|"+p[f+2];e[a].push(O)}}return e}catch(M){console.warn("source: "+c+" cannnot be used, try next source");continue}}console.error("All sources cannot be used!");for(var F=Array(d.url.length),S=0;S<d.url.length;S++)F[S]=[];return F}var ne=[{title:"\u65E5\u671F",width:80,dataIndex:"date"},{title:"\u65F6\u95F4",width:80,dataIndex:"hour"},{title:"BV\u53F7",width:80,dataIndex:"bv",render:function(d){return(0,t.jsx)("a",{href:"https://www.bilibili.com/"+d,target:"_blank",onClick:function(c){c.stopPropagation()},children:d})}},{title:"\u6807\u9898",dataIndex:"title",render:function(d){return(0,t.jsx)(h.Z,{children:(0,t.jsx)(_.Z,{md:12,children:d})})}}],ae=function(g){(0,m.Z)(i,g);var d=(0,P.Z)(i);function i(c){var e;return(0,l.Z)(this,i),e=d.call(this,c),e.state={input:""},e.handleSearch=function(n){e.props.parent.handleSearch(e.state.input)},e.handleClear=function(n){e.setState({input:""});var a=e.props.parent.props.initDatasrc;e.props.parent.setState({dataSource:a,searchWords:"",currentID:0})},e.handleReverse=function(n){e.props.parent.handleReverse()},e}return(0,D.Z)(i,[{key:"render",value:function(){var e=this;return(0,t.jsxs)(w.Z,{onKeyDown:function(a){a.keyCode===13&&e.handleSearch(a)},actions:[(0,t.jsx)(V.Z,{title:"\u9006\u5E8F",onClick:this.handleReverse}),(0,t.jsx)(J.Z,{title:"\u6E05\u9664\u9009\u62E9",onClick:this.handleClear}),(0,t.jsx)(j.Z,{title:"\u641C\u7D22",onClick:this.handleSearch})],children:[(0,t.jsx)(h.Z,{children:(0,t.jsx)(_.Z,{xs:24,md:24,align:"middle",children:(0,t.jsx)($,{level:2,children:"\u5B57\u5E55\u5E93\u68C0\u7D22"})})}),(0,t.jsxs)(h.Z,{style:{height:"50px"},children:[(0,t.jsx)(_.Z,{xs:0,md:6}),(0,t.jsx)(_.Z,{xs:24,md:12,align:"middle",children:(0,t.jsx)(s.Z,{style:{borderRadius:"50px"},placeholder:"\u5355\u6761\u5B57\u5E55\u68C0\u7D22\uFFFD\uFFFD\uFFFD\uFFFD\uFFFD\uFFFD",onChange:function(a){e.setState({input:a.target.value})},value:this.state.input})}),(0,t.jsx)(_.Z,{md:6,align:"middle"})]})]})}}]),i}(I.Component),se=function(g){(0,m.Z)(i,g);var d=(0,P.Z)(i);function i(c){var e;return(0,l.Z)(this,i),e=d.call(this,c),e.state={dataSource:e.props.initDatasrc,isModalVisible:!1,displayBV:"",searchWords:"",currentID:0},e.handleCancel=function(){e.scrollTop(),e.setState({isModalVisible:!1,currentID:0})},e.handleSearch=function(n){e.setState({searchWords:n}),fetch("".concat(v.v.queryAPI),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({words:n})}).then(function(a){a.json().then(function(o){e.setState({dataSource:o});var E=o.length;x.default.info("\u5171"+E.toString()+"\u6761\u641C\u7D22\u7ED3\u679C\u5DF2\u5C55\u793A")})},function(a){console.error(a),x.default.error("\u5B57\u5E55\u5E93\u641C\u7D22\u5931\u8D25")})},e.scrollTop=function(){var n=document.getElementById("Table-top");n.scrollIntoView({behavior:"auto"})},e.scrollNext=function(n){var a=document.getElementsByClassName(n);if(a.length!==0){var o=e.state.currentID;a[o].scrollIntoView({behavior:"smooth"}),o>=a.length-1?e.setState({currentID:0}):e.setState({currentID:o+1})}},e.scrollPre=function(n){var a=document.getElementsByClassName(n);if(a.length!=0){var o=e.state.currentID;a[o].scrollIntoView({behavior:"smooth"}),o<=0?e.setState({currentID:a.length-1}):e.setState({currentID:o-1})}},e}return(0,D.Z)(i,[{key:"componentDidUpdate",value:function(){var e=this.props,n=e.reRender,a=e.parent,o=e.initDatasrc;n&&(this.setState({dataSource:o}),a.setState({reRender:!1}))}},{key:"handleReverse",value:function(){var e=(0,R.GP)(this.state.dataSource);this.setState({dataSource:e})}},{key:"render",value:function(){var e=this,n=this.state,a=n.isModalVisible,o=n.displayBV,E=n.searchWords,C=[];return o!==""&&(C=re(o)),(0,t.jsxs)(A.ZP,{children:[(0,t.jsx)(ae,{parent:this}),(0,t.jsx)(h.Z,{style:{marginTop:"20px"},children:(0,t.jsx)(_.Z,{xs:24,md:24,children:(0,t.jsx)(q.ZP,{columns:this.props.initColumns,rowKey:"key",dataSource:this.state.dataSource,search:!1,onRow:function(f){return{onClick:function(F){e.setState({isModalVisible:!0,displayBV:f.bv})},style:{cursor:"pointer"}}}})})}),(0,t.jsxs)(B.Z,{id:"modal",visible:a,maskClosable:!0,onCancel:this.handleCancel,footer:null,children:[(0,t.jsx)(h.Z,{children:(0,t.jsx)(_.Z,{xs:24,md:24,align:"middle",children:(0,t.jsx)($,{children:"\u5B57\u5E55\u8868"})})}),(0,t.jsx)(h.Z,{children:(0,t.jsx)(_.Z,{children:(0,t.jsxs)("a",{onClick:function(){return e.scrollPre("active-highlight")},children:[(0,t.jsx)(H.Z,{}),"\u4E0A\u4E00\u6761\u641C\u7D22\u7ED3\u679C"]})})}),(0,t.jsx)(h.Z,{children:(0,t.jsx)(_.Z,{children:(0,t.jsxs)("a",{onClick:function(){return e.scrollNext("active-highlight")},children:[(0,t.jsx)(G.Z,{}),"\u4E0B\u4E00\u6761\u641C\u7D22\u7ED3\u679C"]})})}),(0,t.jsxs)(h.Z,{children:[(0,t.jsx)(_.Z,{xs:3,md:3,children:"\u5E8F\u53F7"}),(0,t.jsx)(_.Z,{xs:10,md:10,children:"\u65F6\u95F4"}),(0,t.jsx)(_.Z,{xs:11,md:11,children:"\u5B57\u5E55"})]}),(0,t.jsx)(h.Z,{style:{borderBottom:"2px solid"},children:(0,t.jsx)(ee,{type:"secondary",children:"\u5B57\u5E55\u641C\u7D22\u7ED3\u679C\u4F1A\u4EE5\u9AD8\u4EAE\u5C55\u793A\uFF0C\u7528\u6309\u952E\u4E0A\u4E0B\u79FB\u52A8\u5427\uFFFD\uFFFD\uFFFD\uFFFD\uFFFD\uFFFD\uFFFD\uFFFD\uFFFD\uFFFD\uFFFD\uFFFD\uFFFD\uFFFD\uFFFD\uFFFD\uFFFD\uFFFD"})}),(0,t.jsx)(h.Z,{children:(0,t.jsx)(_.Z,{span:24,style:{height:"500px",overflowY:"scroll"},children:C.map(function(p,f){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.Z,{children:(0,t.jsx)(_.Z,{style:{color:"#9AC8E2",borderBottom:"1px solid"},id:"Table-top",children:(0,t.jsx)("a",{target:"_blank",href:"https://www.bilibili.com/"+o+"?p="+(f+1),children:"\u5207\u7247"+(f+1)})})}),(0,t.jsx)(t.Fragment,{children:p.map(function(O){var F=O.split("|"),S=F[0],M=F[1],z=F[2],oe=parseInt(M.split("-->")[0].split(":")[0]),ie=parseInt(M.split("-->")[0].split(":")[1]),ue=parseInt(M.split("-->")[0].split(":")[2].split(",")[0]),de=(oe*3600+60*ie+ue)*1e3,ce="https://www.bilibili.com/"+o+"?p="+(f+1)+"&start_progress="+de,Q="";return z.toLowerCase().indexOf(E.toLowerCase())!==-1&&(Q="active-highlight"),(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(h.Z,{style:{borderBottom:"1px dashed"},className:Q,children:[(0,t.jsx)(_.Z,{xs:3,md:3,style:{color:"#B8A6D9"},children:S}),(0,t.jsx)(_.Z,{xs:10,md:10,children:(0,t.jsx)("a",{target:"_blank",href:ce,children:M})}),(0,t.jsx)(_.Z,{xs:11,md:11,style:{color:"#E799B0"},children:(0,t.jsx)(N(),{highlightStyle:{backgroundColor:te,padding:0},searchWords:[E],autoEscape:!0,textToHighlight:z})})]})})})})]})})})})]})]})}}]),i}(I.Component),le=function(g){(0,m.Z)(i,g);var d=(0,P.Z)(i);function i(){var c;(0,l.Z)(this,i);for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return c=d.call.apply(d,[this].concat(n)),c.state={mainJson:[],indexerList:[],reRender:!1},c}return(0,D.Z)(i,[{key:"cancelRerender",value:function(){this.setState({reRender:!1}),console.log("\u5DF2\u53D6\u6D88")}},{key:"componentDidMount",value:function(){var e=this;fetch(v.v.MainJsonAPI+"?brief=true").then(function(n){return n.json().then(function(a){e.setState({mainJson:a.data,reRender:!0}),console.log("mainJson\u83B7\u53D6\u6210\u529F")})},function(n){console.error(n)})}},{key:"render",value:function(){var e=this.state,n=e.mainJson,a=e.reRender,o=[];for(var E in n){var C=void 0,p=void 0,f=void 0,O=void 0;try{C=n[E].title,p=n[E].bv,f=n[E].date,O=n[E].time}catch(S){console.error("mainJson parse fault for n: "+E)}o.push({key:E,date:f,hour:O,bv:p,title:C})}o=(0,R.GP)(o);var F={initColumns:ne,initDatasrc:o,reRender:a,parent:this};return(0,t.jsx)(se,(0,Z.Z)({},F))}}]),i}(I.Component);y.default=le}}]);
