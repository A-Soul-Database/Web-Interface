(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[707],{43313:function(k,I,r){"use strict";r.d(I,{v:function(){return w}});var Z=["https://maindata.a-soul-database.vercel.app","https://cdn.jsdelivr.net/gh/A-Soul-Database/A-Soul-Data@latest"],X="8001",T="https://apihk.asdb.live/Api/Subtitle_Search/sub_search",L=0,x="https://apihk.asdb.live/Api/List_Json/V1",w={RunOnLocal:L!==0,sourceUrl:Z[L],queryAPI:T,FliterApi:x+"/Main_Fliter",MainJsonAPI:x+"/Main_Data",IndexerAPI:x+"/Indexer_Data",SubtitlesAPI:x+"/Srt_Data"}},53668:function(k,I,r){"use strict";r.d(I,{VO:function(){return T},Zx:function(){return L},Yu:function(){return x},GP:function(){return w}});var Z=null;function X(u,s){{var l=new Set,D=_createForOfIteratorHelper(s.staff),p;try{for(D.s();!(p=D.n()).done;){var O=p.value;if(O!=="F"){var K=_createForOfIteratorHelper(s.skin[O]),h;try{for(K.s();!(h=K.n()).done;){var Y=h.value;l.add(Y)}}catch(f){K.e(f)}finally{K.f()}}}}catch(f){D.e(f)}finally{D.f()}var _=Array.from(l);if(_.length!==0&&!W(u.skin,_))return!1}var U=_createForOfIteratorHelper(Z),F;try{for(U.s();!(F=U.n()).done;){var A=F.value;if(!W(u[A],s[A]))return!1}}catch(f){U.e(f)}finally{U.f()}if(u.titlestr===""&&u.tagstr===""&&u.typestr===""||s.title.toLowerCase().indexOf(u.titlestr.toLowerCase())!==-1)return!0;{var j=_createForOfIteratorHelper(s.tags),V;try{for(j.s();!(V=j.n()).done;){var J=V.value;if(J.toLowerCase().indexOf(u.tagstr.toLowerCase())!==-1)return!0}}catch(f){j.e(f)}finally{j.f()}}{var b=_createForOfIteratorHelper(s.items),H;try{for(b.s();!(H=b.n()).done;){var G=H.value,S=_createForOfIteratorHelper(G.item),N;try{for(S.s();!(N=S.n()).done;){var B=N.value;if(B[0].toLowerCase().indexOf(u.typestr.toLowerCase())!==-1)return!0}}catch(f){S.e(f)}finally{S.f()}}}catch(f){b.e(f)}finally{b.f()}}return!1}function T(u){var s=new XMLHttpRequest;s.open("GET",u,!1),s.send(null);var l;try{l=JSON.parse(s.responseText)}catch(D){l={title:"error"}}finally{return l}}function L(u,s){var l=new XMLHttpRequest;l.open("POST",u,!1),l.setRequestHeader("Content-Type","application/json");var D=JSON.stringify(s);l.send(D);var p;try{p=JSON.parse(l.responseText)}catch(O){p={title:"error"}}finally{return p}}function x(u){var s=new XMLHttpRequest;s.open("GET",u,!1),s.send(null);var l;if(s.status!==200)throw s.status;try{l=s.responseText}catch(D){throw l="error http",l}finally{return l}}function w(u){for(var s=[],l=u.length-1;l>=0;l--)s.push(u[l]);return s}function W(u,s){return u.length+s.length!==Array.from(new Set([].concat(_toConsumableArray(u),_toConsumableArray(s)))).length}},145:function(k,I,r){"use strict";r.r(I);var Z=r(75106),X=r(83166),T=r(94352),L=r(94966),x=r(46429),w=r(79873),W=r(66551),u=r(96343),s=r(74280),l=r(54597),D=r(2431),p=r(67857),O=r(77852),K=r(61947),h=r(58336),Y=r(12489),_=r(53530),U=r(91434),F=r(53104),A=r(59301),j=r(22444),V=r(54348),J=r(18999),b=r(89122),H=r(14687),G=r(18422),S=r(50666),N=r.n(S),B=r(53668),f=r(43313),q=r(74414),e=r(37712),$=F.Z.Title,ee=F.Z.Text,te="yellow";function re(g){var d=(0,B.VO)(f.v.SubtitlesAPI+"?bv="+g).data;console.log(d);for(var i=0;i<d.sources.length;i++){var c=d.sources[i];console.log("try source:"+c);try{for(var t=Array(d.url.length),n=0;n<d.url.length;n++)t[n]=[];for(var a=0;a<d.url.length;a++){var o=d.url[a],E=c+o,P="";try{P=(0,B.Yu)(E)}catch(M){throw console.error("getSubtitles fail, status:"+M.toString()),c}for(var m=P.split(`
`),v=0;v<m.length-2;v+=4){var y=m[v]+"|"+m[v+1]+"|"+m[v+2];t[a].push(y)}}return t}catch(M){console.warn("source: "+c+" cannnot be used, try next source");continue}}console.error("All sources cannot be used!");for(var C=Array(d.url.length),R=0;R<d.url.length;R++)C[R]=[];return C}var ne=[{title:"\u65E5\u671F",width:80,dataIndex:"date"},{title:"\u65F6\u95F4",width:80,dataIndex:"hour"},{title:"BV\u53F7",width:80,dataIndex:"bv",render:function(d){return(0,e.jsx)("a",{href:"https://www.bilibili.com/"+d,target:"_blank",onClick:function(c){c.stopPropagation()},children:d})}},{title:"\u6807\u9898",dataIndex:"title",render:function(d){return(0,e.jsx)(h.Z,{children:(0,e.jsx)(_.Z,{md:12,children:d})})}}],ae=function(g){(0,p.Z)(i,g);var d=(0,O.Z)(i);function i(c){var t;return(0,l.Z)(this,i),t=d.call(this,c),t.state={input:""},t.handleSearch=function(n){t.props.parent.handleSearch(t.state.input)},t.handleClear=function(n){t.setState({input:""});var a=t.props.parent.props.initDatasrc;t.props.parent.setState({dataSource:a,searchWords:"",currentID:0})},t.handleReverse=function(n){t.props.parent.handleReverse()},t}return(0,D.Z)(i,[{key:"render",value:function(){var t=this;return(0,e.jsxs)(W.Z,{onKeyDown:function(a){a.keyCode===13&&t.handleSearch(a)},actions:[(0,e.jsx)(V.Z,{title:"\u9006\u5E8F",onClick:this.handleReverse}),(0,e.jsx)(J.Z,{title:"\u6E05\u9664\u9009\u62E9",onClick:this.handleClear}),(0,e.jsx)(b.Z,{title:"\u641C\u7D22",onClick:this.handleSearch})],children:[(0,e.jsx)(h.Z,{children:(0,e.jsx)(_.Z,{xs:24,md:24,align:"middle",children:(0,e.jsx)($,{level:2,children:"\u5B57\u5E55\u5E93\u68C0\u7D22"})})}),(0,e.jsxs)(h.Z,{style:{height:"50px"},children:[(0,e.jsx)(_.Z,{xs:0,md:6}),(0,e.jsx)(_.Z,{xs:24,md:12,align:"middle",children:(0,e.jsx)(s.Z,{style:{borderRadius:"50px"},placeholder:"\u5355\u6761\u5B57\u5E55\u68C0\u7D22\u{1F50D}",onChange:function(a){t.setState({input:a.target.value})},value:this.state.input})}),(0,e.jsx)(_.Z,{md:6,align:"middle"})]}),(0,e.jsxs)(W.Z,{children:[(0,e.jsx)("b",{style:{float:"left",margin:"1rem",fontSize:"1.5rem"},children:"\u81F4A-SOUL\u8FD0\u8425\u59D4\u5458\u4F1A\u7684\u58F0\u660E"}),(0,e.jsx)("a",{href:"https://t.bilibili.com/658648606533746724",style:{float:"right",margin:"1rem",fontSize:"1.5rem"},children:"\u70B9\u6B64\u67E5\u770B"})]})]})}}]),i}(A.Component),se=function(g){(0,p.Z)(i,g);var d=(0,O.Z)(i);function i(c){var t;return(0,l.Z)(this,i),t=d.call(this,c),t.state={dataSource:t.props.initDatasrc,isModalVisible:!1,displayBV:"",searchWords:"",currentID:0},t.handleCancel=function(){t.scrollTop(),t.setState({isModalVisible:!1,currentID:0})},t.handleSearch=function(n){t.setState({searchWords:n}),fetch("".concat(f.v.queryAPI),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({words:n})}).then(function(a){a.json().then(function(o){t.setState({dataSource:o});var E=o.length;x.default.info("\u5171"+E.toString()+"\u6761\u641C\u7D22\u7ED3\u679C\u5DF2\u5C55\u793A")})},function(a){console.error(a),x.default.error("\u5B57\u5E55\u5E93\u641C\u7D22\u5931\u8D25")})},t.scrollTop=function(){var n=document.getElementById("Table-top");n.scrollIntoView({behavior:"auto"})},t.scrollNext=function(n){var a=document.getElementsByClassName(n);if(a.length!==0){var o=t.state.currentID;a[o].scrollIntoView({behavior:"smooth"}),o>=a.length-1?t.setState({currentID:0}):t.setState({currentID:o+1})}},t.scrollPre=function(n){var a=document.getElementsByClassName(n);if(a.length!=0){var o=t.state.currentID;a[o].scrollIntoView({behavior:"smooth"}),o<=0?t.setState({currentID:a.length-1}):t.setState({currentID:o-1})}},t}return(0,D.Z)(i,[{key:"componentDidUpdate",value:function(){var t=this.props,n=t.reRender,a=t.parent,o=t.initDatasrc;n&&(this.setState({dataSource:o}),a.setState({reRender:!1}))}},{key:"handleReverse",value:function(){var t=(0,B.GP)(this.state.dataSource);this.setState({dataSource:t})}},{key:"render",value:function(){var t=this,n=this.state,a=n.isModalVisible,o=n.displayBV,E=n.searchWords,P=[];return o!==""&&(P=re(o)),(0,e.jsxs)(j.ZP,{children:[(0,e.jsx)(ae,{parent:this}),(0,e.jsx)(h.Z,{style:{marginTop:"20px"},children:(0,e.jsx)(_.Z,{xs:24,md:24,children:(0,e.jsx)(q.ZP,{columns:this.props.initColumns,rowKey:"key",dataSource:this.state.dataSource,search:!1,onRow:function(v){return{onClick:function(C){t.setState({isModalVisible:!0,displayBV:v.bv})},style:{cursor:"pointer"}}}})})}),(0,e.jsxs)(T.Z,{id:"modal",visible:a,maskClosable:!0,onCancel:this.handleCancel,footer:null,children:[(0,e.jsx)(h.Z,{children:(0,e.jsx)(_.Z,{xs:24,md:24,align:"middle",children:(0,e.jsx)($,{children:"\u5B57\u5E55\u8868"})})}),(0,e.jsx)(h.Z,{children:(0,e.jsx)(_.Z,{children:(0,e.jsxs)("a",{onClick:function(){return t.scrollPre("active-highlight")},children:[(0,e.jsx)(H.Z,{}),"\u4E0A\u4E00\u6761\u641C\u7D22\u7ED3\u679C"]})})}),(0,e.jsx)(h.Z,{children:(0,e.jsx)(_.Z,{children:(0,e.jsxs)("a",{onClick:function(){return t.scrollNext("active-highlight")},children:[(0,e.jsx)(G.Z,{}),"\u4E0B\u4E00\u6761\u641C\u7D22\u7ED3\u679C"]})})}),(0,e.jsxs)(h.Z,{children:[(0,e.jsx)(_.Z,{xs:3,md:3,children:"\u5E8F\u53F7"}),(0,e.jsx)(_.Z,{xs:10,md:10,children:"\u65F6\u95F4"}),(0,e.jsx)(_.Z,{xs:11,md:11,children:"\u5B57\u5E55"})]}),(0,e.jsx)(h.Z,{style:{borderBottom:"2px solid"},children:(0,e.jsx)(ee,{type:"secondary",children:"\u5B57\u5E55\u641C\u7D22\u7ED3\u679C\u4F1A\u4EE5\u9AD8\u4EAE\u5C55\u793A\uFF0C\u7528\u6309\u952E\u4E0A\u4E0B\u79FB\u52A8\u5427\u{1F483}\u{1F483}\u{1F483}"})}),(0,e.jsx)(h.Z,{children:(0,e.jsx)(_.Z,{span:24,style:{height:"500px",overflowY:"scroll"},children:P.map(function(m,v){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(h.Z,{children:(0,e.jsx)(_.Z,{style:{color:"#9AC8E2",borderBottom:"1px solid"},id:"Table-top",children:(0,e.jsx)("a",{target:"_blank",href:"https://www.bilibili.com/"+o+"?p="+(v+1),children:"\u5207\u7247"+(v+1)})})}),(0,e.jsx)(e.Fragment,{children:m.map(function(y){var C=y.split("|"),R=C[0],M=C[1],z=C[2],oe=parseInt(M.split("-->")[0].split(":")[0]),ie=parseInt(M.split("-->")[0].split(":")[1]),ue=parseInt(M.split("-->")[0].split(":")[2].split(",")[0]),de=(oe*3600+60*ie+ue)*1e3,ce="https://www.bilibili.com/"+o+"?p="+(v+1)+"&start_progress="+de,Q="";return z.toLowerCase().indexOf(E.toLowerCase())!==-1&&(Q="active-highlight"),(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(h.Z,{style:{borderBottom:"1px dashed"},className:Q,children:[(0,e.jsx)(_.Z,{xs:3,md:3,style:{color:"#B8A6D9"},children:R}),(0,e.jsx)(_.Z,{xs:10,md:10,children:(0,e.jsx)("a",{target:"_blank",href:ce,children:M})}),(0,e.jsx)(_.Z,{xs:11,md:11,style:{color:"#E799B0"},children:(0,e.jsx)(N(),{highlightStyle:{backgroundColor:te,padding:0},searchWords:[E],autoEscape:!0,textToHighlight:z})})]})})})})]})})})})]})]})}}]),i}(A.Component),le=function(g){(0,p.Z)(i,g);var d=(0,O.Z)(i);function i(){var c;(0,l.Z)(this,i);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return c=d.call.apply(d,[this].concat(n)),c.state={mainJson:[],indexerList:[],reRender:!1},c}return(0,D.Z)(i,[{key:"cancelRerender",value:function(){this.setState({reRender:!1}),console.log("\u5DF2\u53D6\u6D88")}},{key:"componentDidMount",value:function(){var t=this;fetch(f.v.MainJsonAPI+"?brief=true").then(function(n){return n.json().then(function(a){t.setState({mainJson:a.data,reRender:!0}),console.log("mainJson\u83B7\u53D6\u6210\u529F")})},function(n){console.error(n)})}},{key:"render",value:function(){var t=this.state,n=t.mainJson,a=t.reRender,o=[];for(var E in n){var P=void 0,m=void 0,v=void 0,y=void 0;try{P=n[E].title,m=n[E].bv,v=n[E].date,y=n[E].time}catch(R){console.error("mainJson parse fault for n: "+E)}o.push({key:E,date:v,hour:y,bv:m,title:P})}o=(0,B.GP)(o);var C={initColumns:ne,initDatasrc:o,reRender:a,parent:this};return(0,e.jsx)(se,(0,Z.Z)({},C))}}]),i}(A.Component);I.default=le}}]);
